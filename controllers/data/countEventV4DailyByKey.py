# -*- coding: utf-8 -*-
"""
    计算前端埋点日生产量
    计算后端埋点日生产量
    计算埋点日生产量
    create eventV4DailyProductionEventsCount.json in same dir first time
    sample data:
    [
        {"date":"2016-12-25","app":234234, "backend": 23433, "total": 4355334},
        {"date":"2016-12-25","app":234234, "backend": 23433, "total": 4355334},
        {"date":"2016-12-25","app":234234, "backend": 23433, "total": 4355334}
    ]
"""

import pymongo
from pymongo import MongoClient
from datetime import datetime
import datetime
import json
from StringIO import StringIO
import time
from datetime import date
import calendar
import dateutil.parser

"""
    Part.1 database connector && generater date range
"""

db_host = MongoClient("10.8.8.111", 27017)
db_events_v4 = db_host["eventsV4"]
db_events_v4_collection = db_events_v4["eventV4"]

TODAY_DATE = datetime.datetime.now()
END_DATE = datetime.datetime(TODAY_DATE.year, TODAY_DATE.month, TODAY_DATE.day, 16) - datetime.timedelta(days=1)
START_DATE = END_DATE - datetime.timedelta(days=1)

event_list = [
    "ApkDownloadUrlIllegal",
    "DownLoadLocalCacheNum",
    "DownLoadVideoAddVideo",
    "EnterMoviePlayCompleteVC",
    "EnterMoviePlayerVC",
    "EnterMyLearnVC",
    "EnterSetCourseVC",
    "EnterSetGradeVC",
    "EnterTopicDetailVC",
    "EnterUserGuideVC",
    "HaltApp",
    "PayCancelWithErrorMessage",
    # "TestReceiptOrderId",
    # "VideoCompleteIgnoreClicked",
    # "VideoCompleteRequestScoreFailed",
    # "VideoCompleteReturnClicked",
    # "VideoPlayCompletePlay",
    # "VideoPlayStartPlay",
    # "answerProblem",
    # "answerVideoInteraction",
    # "batchAddStudentsSuccess",
    # "bindPhone",
    # "bufferFailure",
    # "bufferSuccess",
    # "buyAvatarSuccess",
    # "challengeFailure",
    # "challengeSuccess",
    # "changePasswordSuccess",
    # "changeProfileAvatar",
    # "changeProfileAvatarSuccess",
    # "chooseFinishedChallenge",
    # "clcikTHClickWatch",
    # "clickAHAvatar",
    # "clickAHCurrencyButton",
    # "clickAHENSave",
    # "clickAHEditName",
    # "clickAHIPContinue",
    # "clickAHIPFinish",
    # "clickAHLevelInfo",
    # "clickAHReport",
    # "clickAHShare",
    # "clickAHSkill",
    # "clickAHStore",
    # "clickALDownloadApp",
    # "clickALPrint",
    # "clickASBatchAdd",
    # "clickASSelfAdd",
    # "clickASShare",
    # "clickASShareBanner",
    # "clickAUPDownload",
    # "clickBAComfirm",
    # "clickBAPBuy",
    # "clickBASGenerateAccountList",
    # "clickBG1Continue",
    # "clickBG1Contiue",
    # "clickBG2ContinueVideo",
    # "clickBG3Continue",
    # "clickBG3ContinueProblem",
    # "clickBG3Explanation",
    # "clickBG3ReturnProblem",
    # "clickBG3Submit",
    # "clickBGBack",
    # "clickBGSkip",
    # "clickBGSkipStep",
    # "clickBGStart",
    # "clickBPBind",
    # "clickBPExit",
    # "clickBPSendCode",
    # "clickBhapterTheme",
    # "clickBuffer",
    # "clickBufferManagement",
    # "clickCCPCancel",
    # "clickCCPConfirm",
    # "clickCDPDStudent",
    # "clickCIBindPhone",
    # "clickCIEditName",
    # "clickCIExit",
    # "clickCIPhoneGet",
    # "clickCLCSPChapter",
    # "clickCLCSPPublisherSemesterSwitch",
    # "clickCLClassId",
    # "clickCLDChapter",
    # "clickCLDSelectChapter",
    # "clickCLDSelectSemester",
    # "clickCLDSemester",
    # "clickCLDTeachGoal",
    # "clickCLDTheam",
    # "clickCLDTopicState",
    # "clickCLDTopicUserDetail",
    # "clickCLDTopicUserList",
    # "clickCLDUserList",
    # "clickCLLogin",
    # "clickCLLoginNow",
    # "clickCLPPFinish",
    # "clickCLSignup",
    # "clickCLUPContinue",
    # "clickCMBatchAdd",
    # "clickCMCCNext",
    # "clickCMCreateClass",
    # "clickCMDCYes",
    # "clickCMDeleteClass",
    # "clickCMECSave",
    # "clickCMEdit",
    # "clickCMExamine",
    # "clickCMRemoveStudent",
    # "clickCMResetPassword",
    # "clickCMSelfAdd",
    # "clickCNExit",
    # "clickCNToRelated",
    # "clickCPCreateClass",
    # "clickCPData",
    # "clickCPEButton",
    # "clickCPMAddStudent",
    # "clickCPMDissolveClass",
    # "clickCPMEditClassName",
    # "clickCPMGetList",
    # "clickCPManager",
    # "clickCSExit",
    # "clickCSTofill",
    # "clickCallDraftBtn",
    # "clickChapterApp",
    # "clickChapterAvatar",
    # "clickChapterBanner",
    # "clickChapterBannerExit",
    # "clickChapterBubble",
    # "clickChapterChapter",
    # "clickChapterCreateGroup",
    # "clickChapterGroup",
    # "clickChapterJoinGroup",
    # "clickChapterListVIew",
    # "clickChapterManagerGroup",
    # "clickChapterMath",
    # "clickChapterPhoneExit",
    # "clickChapterPhysics",
    # "clickChapterPhysicsExit",
    # "clickChapterPhysicsNow",
    # "clickChapterPresent",
    # "clickChapterPublisher",
    # "clickChapterPyhysicsExit",
    # "clickChapterPyhysicsNow",
    # "clickChapterQQGroup",
    # "clickChapterSelectGroup",
    # "clickChapterSelectPublisher",
    # "clickChapterSelectSemester",
    # "clickChapterSelectSubject",
    # "clickChapterSemester",
    # "clickChapterSetting",
    # "clickChapterSubject",
    # "clickChapterTHeme",
    # "clickChapterTheam",
    # "clickChapterTheme",
    # "clickChapterTreeView",
    # "clickChapterUserInfo",
    # "clickChapterVIew",
    # "clickChapterView",
    # "clickChapterWechat",
    # "clickChapterWeibo",
    # "clickCloseChapterList",
    # "clickCloseDraft",
    # "clickCloseTeacherGuidePage",
    # "clickCloseVideoLaggingCheck",
    # "clickContinueLearning",
    # "clickContinueNextProblemSet",
    # "clickDMDelete",
    # "clickDMDownloadedTab",
    # "clickDMDownloadingTab",
    # "clickDMEdit",
    # "clickDMSelectAll",
    # "clickDownloadTopicVideo",
    # "clickDraftClear",
    # "clickDraftClose",
    # "clickDraftExit",
    # "clickEVSkip",
    # "clickEnterLearning",
    # "clickEnterMaster",
    # "clickEnterTeacherGuideBtn",
    # "clickEnterTopic",
    # "clickExperience",
    # "clickFAQ",
    # "clickFBProblem",
    # "clickFBSubmit",
    # "clickFPComfirmAccount",
    # "clickFeedback",
    # "clickGMNewGroup",
    # "clickGMQuitGroup",
    # "clickGoPhysics",
    # "clickHaveARest",
    # "clickHomeDownloadAndroid",
    # "clickHomeDownloadWindows",
    # "clickHomeDownloadiOS",
    # "clickHomeEnterRoom",
    # "clickHomeForgetPassword",
    # "clickHomeFreeUse",
    # "clickHomeLogin",
    # "clickHomeLoginQQLogin",
    # "clickHomeLoginTab",
    # "clickHomeSignupNow",
    # "clickHomeSignupQQLogin",
    # "clickHomeSignupTab",
    # "clickHomeSubmitProblem",
    # "clickHomeSwitchStudent",
    # "clickHomeSwitchTeacher",
    # "clickHomeToDownloadAndroid",
    # "clickHomeToDownloadWindows",
    # "clickHomeToDownloadiOS",
    # "clickHomeToLogin",
    # "clickHomeToSignup",
    # "clickHomeUseNow",
    # "clickHomeWatchVideo",
    # "clickJGJoin",
    # "clickLPForgetPassword",
    # "clickLPLogin",
    # "clickLPQQLogin",
    # "clickLPSignupNow",
    # "clickLogLater",
    # "clickMSResendResetMail",
    # "clickMTClass",
    # "clickMTOverview",
    # "clickMTTeacher",
    # "clickMTToTeacher",
    # "clickMVSendResetMail",
    # "clickManagerGroup",
    # "clickNEtitle",
    # "clickNGCreate",
    # "clickNNTitle",
    # "clickNNToget",
    # "clickNNToread",
    # "clickNavAllChapter",
    # "clickNavCoins",
    # "clickNavCurriculum",
    # "clickNavMyLearning",
    # "clickNavOnionStore",
    # "clickNavPower",
    # "clickNavRank",
    # "clickNavTeacherKeti",
    # "clickNavTeacherManual",
    # "clickNavTeacherPage",
    # "clickNavToManager",
    # "clickNavUILogout",
    # "clickNavUIUserCenter",
    # "clickNavUserCenter",
    # "clickNavVIP",
    # "clickNextProblem",
    # "clickNoticeEvents",
    # "clickNoticeExit",
    # "clickNoticeNotice",
    # "clickOSChargeCoupon",
    # "clickOSChargeInstruction",
    # "clickOSCoinInstruction",
    # "clickOSSelectAvatar",
    # "clickPFContinue",
    # "clickPFRest",
    # "clickPFToVideo",
    # "clickPLDesc",
    # "clickPLLicense",
    # "clickPLOption",
    # "clickPNPExit",
    # "clickPNPQQ",
    # "clickPNPWechat",
    # "clickPPBox",
    # "clickPPConfirm",
    # "clickPPDLevel",
    # "clickPPExit",
    # "clickPPHBuy",
    # "clickPPHDetail",
    # "clickPPHReport",
    # "clickPPMethod",
    # "clickPPPGet",
    # "clickPPPaynow",
    # "clickPPShare",
    # "clickPPWechatLink",
    # "clickPRselect",
    # "clickPSCConfirm",
    # "clickPSCExit",
    # "clickPSCNext",
    # "clickPVSkip",
    # "clickPaymentBotton",
    # "clickPaymentDesc",
    # "clickPaymentExit",
    # "clickPaymentExperience",
    # "clickPaymentGetMascot",
    # "clickPaymentLeadPay",
    # "clickPaymentLicense",
    # "clickPaymentOption",
    # "clickPaymentParentPay",
    # "clickPaymentPayNow",
    # "clickPaymentPlayVideo",
    # "clickPaymentPromotionBanner",
    # "clickPaymentQuestionnaire",
    # "clickPaymentReport",
    # "clickPaymentSendLink",
    # "clickPaymentSwitch",
    # "clickPaymentVideo",
    # "clickProbleeExit",
    # "clickProblemContinue",
    # "clickProblemDraft",
    # "clickProblemExit",
    # "clickProblemExplain",
    # "clickProblemExplanation",
    # "clickProblemOption",
    # "clickProblemReasons",
    # "clickProblemSubmit",
    # "clickProblemTextbox",
    # "clickProfileBtn",
    # "clickQGPConfirm",
    # "clickQuitLearningSeries",
    # "clickREPToReport",
    # "clickRGItem",
    # "clickRIPCopy",
    # "clickRLCPGet",
    # "clickRLLike",
    # "clickRLLoginNow",
    # "clickRLShare",
    # "clickRLSignupNow",
    # "clickRLVIP",
    # "clickRPResetPassword",
    # "clickRRPExit",
    # "clickRRPSubmit",
    # "clickRSExit",
    # "clickRSGenerateCurriculum",
    # "clickRankInvite",
    # "clickRankJoin",
    # "clickRankManager",
    # "clickRankNewGroup",
    # "clickRankTotalRank",
    # "clickRankWeekRank",
    # "clickRateApp",
    # "clickRefreshTopic",
    # "clickReturnFromBufferManagement",
    # "clickReturnFromProfilePage",
    # "clickReturnFromSwitchBook",
    # "clickReturnFromSwitchGrade",
    # "clickReturnFromTopicPage",
    # "clickSAGPrint",
    # "clickSAGuide",
    # "clickSFAQFeedback",
    # "clickSGExit",
    # "clickSGSignup",
    # "clickSICoin",
    # "clickSILevel",
    # "clickSPLicense",
    # "clickSPLoginNow",
    # "clickSPQQLogin",
    # "clickSPSPublisher",
    # "clickSPSignup",
    # "clickSRSExit",
    # "clickSRSRoute",
    # "clickSSLCity",
    # "clickSSLCounty",
    # "clickSSLExit",
    # "clickSSLProvince",
    # "clickSSLSchool",
    # "clickSSSSemester",
    # "clickSSSSubject",
    # "clickSVGetSMSCode",
    # "clickSVPDownloadApp",
    # "clickSVPShareVideo",
    # "clickSVPToHome",
    # "clickSVPToLogin",
    # "clickSVPToSignup",
    # "clickSVResetPassword",
    # "clickSattingSemester",
    # "clickSelectPublisher",
    # "clickSelectSemester",
    # "clickSetti.gUserInfo",
    # "clickSettingBindPhone",
    # "clickSettingBoxfish",
    # "clickSettingBtn",
    # "clickSettingDownload",
    # "clickSettingFAQ",
    # "clickSettingFeedback",
    # "clickSettingGuideBannerSwitch",
    # "clickSettingHomeBufferIconSwitch",
    # "clickSettingLogout",
    # "clickSettingMobileNetSwitch",
    # "clickSettingNotice",
    # "clickSettingNotification",
    # "clickSettingPublisher",
    # "clickSettingRoom",
    # "clickSettingSchool",
    # "clickSettingSelectSubject",
    # "clickSettingSemester",
    # "clickSettingShareApp",
    # "clickSettingTarget",
    # "clickSettingToRate",
    # "clickSettingToShareApp",
    # "clickSettingUserInfo",
    # "clickSignupBtn",
    # "clickStartChallenge",
    # "clickStartProblemSet",
    # "clickStartProblemSetAgain",
    # "clickStroeSelectAvatar",
    # "clickSwitchBook",
    # "clickSwitchGrade",
    # "clickTAVEExit",
    # "clickTAVESubmit",
    # "clickTBPPToBind",
    # "clickTBWSkip",
    # "clickTDPStart",
    # "clickTDPToManager",
    # "clickTFPPBox",
    # "clickTFPPConfirm",
    # "clickTFRest",
    # "clickTGFMore",
    # "clickTGStart",
    # "clickTHomeDownloadAndroid",
    # "clickTHomeDownloadWindows",
    # "clickTHomeDownloadiOS",
    # "clickTHomeFreeUse",
    # "clickTHomeToDownloadAndroid",
    # "clickTHomeToDownloadWindows",
    # "clickTHomeToDownloadiOS",
    # "clickTHomeToWatchVideo",
    # "clickTHomeWatchAdvancedVideo",
    # "clickTHomeWatchElementaryVideo",
    # "clickTHomeWatchGuideVideo",
    # "clickTMASave",
    # "clickTMAddUser",
    # "clickTMCSave",
    # "clickTMCreateClass",
    # "clickTMCreateUser",
    # "clickTMDDelete",
    # "clickTMDeleTeacher",
    # "clickTMDownload",
    # "clickTMEReset",
    # "clickTMESave",
    # "clickTMEditTeacher",
    # "clickTMMore",
    # "clickTMPreview",
    # "clickTMSPLearning",
    # "clickTMSPPractice",
    # "clickTMToAddStudents",
    # "clickTPCPConfirm",
    # "clickTPExamine",
    # "clickTPGStart",
    # "clickTPPIntroduction",
    # "clickTPPToPay",
    # "clickTPPUseCoupon",
    # "clickTPVEExit",
    # "clickTPVESubmit",
    # "clickTTTPConfirm",
    # "clickTVGSProblem",
    # "clickThemeDownload",
    # "clickThemeToContinue",
    # "clickThemeToContinueFrom",
    # "clickThemeToRelated",
    # "clickThemeTongdian",
    # "clickThemeTopic",
    # "clickThemeTopicIcon",
    # "clickThemeTopicTypeIcon",
    # "clickUCAvatar",
    # "clickUCBQBind",
    # "clickUCBindNewPhone",
    # "clickUCBindPhone",
    # "clickUCBindQQ",
    # "clickUCCoupon",
    # "clickUCCreateGroup",
    # "clickUCEGGender",
    # "clickUCEMSave",
    # "clickUCFindSchool",
    # "clickUCGender",
    # "clickUCJoinGroup",
    # "clickUCLogout",
    # "clickUCMPSave",
    # "clickUCMRJoin",
    # "clickUCMRSearch",
    # "clickUCMail",
    # "clickUCModifyPassword",
    # "clickUCMyRoom",
    # "clickUCName",
    # "clickUCPasswordManager",
    # "clickUCPay",
    # "clickUCSBBind",
    # "clickUCSBUnbind",
    # "clickUCSave",
    # "clickUCSelectSemester",
    # "clickUCSocialBinding",
    # "clickUCUserProfile",
    # "clickUserLogBtn",
    # "clickVEPContinue",
    # "clickVEPExit",
    # "clickVEPRenew",
    # "clickVFContinue",
    # "clickVFRest",
    # "clickVFToShare",
    # "clickVIPPrectionConfirm",
    # "clickVSPExit",
    # "clickVSPSubmit",
    # "clickVideoDownload",
    # "clickVideoExit",
    # "clickVideoInteracti/n",
    # "clickVideoInteractign",
    # "clickVideoInteraction",
    # "clickVideoPause",
    # "clickVideoRefresh",
    # "clickVideoResume",
    # "clickVideoRollback",
    # "clickVideoSelectResolution",
    # "clickVideoSkip",
    # "clickVideoToExit",
    # "clickVideoToShare",
    # "clickVideoToggleFullScreen",
    # "clickVideoToggleMute",
    # "clickVideoVIPShowup",
    # "clickproblemSubmit",
    # "clic�DraftClear",
    # "createCircleSuccess",
    # "createOrderFailure",
    # "createRoomSuccess",
    # "c�ickThemeTopic",
    # "delLocalRetry",
    # "deleteRoomSuccess",
    # "downloadAndroidApp",
    # "downloadApkSignatureDiff",
    # "downloadiOSApp",
    # "dragVideo",
    # "enterAHEditName",
    # "enterAHInitPop",
    # "enterAUPDownloadSuccess",
    # "enterAbilityHome",
    # "enterAbilityLanding",
    # "enterAbilityShare",
    # "enterAutoUpdatePop",
    # "enterBatchAddSuccess",
    # "enterBeginnersGuide",
    # "enterBindPhone",
    # "enterBufferManagementHome",
    # "enterChallenge",
    # "enterChapteqListChapterSelectPop",
    # "enterChapter",
    # "enterChapterList",
    # "enterChapterListChapterSelectPnp",
    # "enterChapterListChapterSelectPop",
    # "enterChapterListChapterSelect�op",
    # "enterChapterListPage",
    # "enterChapterListUpdatePop",
    # "enterChapterNotice",
    # "enterChapterPhone",
    # "enterChapterPrensents",
    # "enterChapterSchool",
    # "enterChapterSelectNotice",
    # "enterChapterTaskNotice",
    # "enterChoosePublisherPage",
    # "enterClassLogin",
    # "enterClassPage",
    # "enterCouponIntro",
    # "enterDownloadManager",
    # "enterDraft",
    # "enterForgetPassword",
    # "enterGroupManager",
    # "enterGuidePage",
    # "enterHome",
    # "enterHyperVideo",
    # "enterJoinGroup",
    # "enterLearning",
    # "enterLoginPage",
    # "enterManagement",
    # "enterMaster",
    # "enterMobileSite",
    # "enterMyProfile",
    # "enterNavNote",
    # "enterNetworkConnectionCheck",
    # "enterNewGroup",
    # "enterNotice",
    # "enterNoticeEvents",
    # "enterNoticeNotice",
    # "enterOnionStore",
    # "enterPPHFailure",
    # "enterPPHSuccess",
    # "enterParentPay",
    # "enterParentPayH5",
    # "enterPayNowPop",
    # "enterPayment",
    # "enterPaymentBridge",
    # "enterPaymentLanding",
    # "enterPaymentPromotionPop",
    # "enterPaymentSuccessPop",
    # "enterPendingPaymentQuestionnairePop",
    # "enterPeriodTest",
    # "enterPracticeFailure",
    # "enterPracticeProblemDetail",
    # "enterPresentPop",
    # "enterProBlem",
    # "enterProblem",
    # "enterProblemSet",
    # "enterPublisherSemesterChoose",
    # "enterRLPage",
    # "enterRank",
    # "enterRefuseRenewPoll",
    # "enterRenewUnavailable",
    # "enterReportEnabledPop",
    # "enterReportLanding",
    # "enterReportShareCoinPop",
    # "enterResetPassword",
    # "enterResetPasswordSuccess",
    # "enterRoomLogin",
    # "enterRouteSelection",
    # "enterSSLCity",
    # "enterSSLCounty",
    # "enterSSLProvince",
    # "enterSSLSchool",
    # "enterSelfAdd",
    # "enterSelfAddGuide",
    # "enterSendCoinPop",
    # "enterSendCouponPop",
    # "enterSendInvititionPop",
    # "enterSetting",
    # "enterSettingFAQ",
    # "enterSettingPage",
    # "enterSettingPublisherSelect",
    # "enterSettingSchool",
    # "enterSettingSemesterSelect",
    # "enterSettingSubjectSelect",
    # "enterShareVideoPage",
    # "enterSignupGuide",
    # "enterSignupPage",
    # "enterStartUp",
    # "enterStore",
    # "enterStoreInstruction",
    # "enterSuccess",
    # "enterSwitchBookPage",
    # "enterSwitchGradePage",
    # "enterTAVideoExitPoll",
    # "enterTPVideoExitPoll",
    # "enterTeacherGuide",
    # "enterTeacherGuideFinish",
    # "enterTeacherHome",
    # "enterTeacherPage",
    # "enterTeacherPracticeGuide",
    # "enterTeacherVideoGuide",
    # "enterTeacherVideoGuideSummary",
    # "enterTheme",
    # "enterThemeDownloadPop",
    # "enterThemeModuleSelectPop",
    # "enterThmme",
    # "enterToBindPhonePop",
    # "enterTopic",
    # "enterTopicFinish",
    # "enterTypeBWelcome",
    # "enterTypePayablePop",
    # "enterUCBindQQ",
    # "enterUCEditGender",
    # "enterUCEditMail",
    # "enterUCModifyPassword",
    # "enterUserCenter",
    # "enterUserLicense",
    # "enterVIPExpirationPop",
    # "enterVIPSatisfactionPoll",
    # "enterVIPSatisfactoryPoll",
    # "enterVhdeo",
    # "enterVideo",
    # "enterVideoExitPop",
    # "enterVideoFinish",
    # "enterVideoLaggingCheck",
    # "enterVideoLoadingCheck",
    # "finishHyperVideo",
    # "finishLearning",
    # "finishLearningUnreg",
    # "finishPaymentVideo",
    # "finishProblemSet",
    # "finishVideo",
    # "finkshVideo",
    # "getFreeCouponSuccess",
    # "getNoticePrompted",
    # "getProfile",
    # "getProgress",
    # "getProgressState",
    # "getQiniuResFailure",
    # "getQiniuResSuccess",
    # "getSettingPrompted",
    # "getThemeProgress",
    # "getgoodsInfoFailure",
    # "gotDownloadApkUrl",
    # "haltApp",
    # "hello",
    # "initApp",
    # "joinCircleSuccess",
    # "joinRoomFailure",
    # "joinRoomSuccess",
    # "loginFailure",
    # "loginSuccess",
    # "logoutSuccess",
    # "logout_btn_clicked",
    # "logout_successed",
    # "modifyChoice",
    # "pageOnPause",
    # "pageOnResume",
    # "pauseVideo",
    # "payCancel",
    # "payInvalid",
    # "payMoneySuccessfully",
    # "payVerifyError",
    # "payVerifyFailure",
    # "payfailureIndelegate",
    # "paymentFinishVideo",
    # "paymentFinisvideoIdeo",
    # "popServerError",
    # "practiceWaitLongerThan5s",
    # "presentEnabled",
    # "problemAnswered",
    # "problemSetFailure",
    # "problemSetSuccess",
    # "purchaseTrialCoupon",
    # "qqBindFailure",
    # "qqBindSuccess",
    # "qqLoginFailure",
    # "qqLoginSuccess",
    # "qqSignupFailure",
    # "qqSignupSuccess",
    # "quitCircleSuccess",
    # "quitProblemSet",
    # "quitRoomSuccess",
    # "quitVideo",
    # "realDateFasterThanSeverDate",
    # "recordLocation",
    # "registFailure",
    # "reportRewards",
    # "resumeVideo",
    # "sendCouponRequest",
    # "shareVideo",
    # "shareVideoAfterComplete",
    # "showPhysicsBanner",
    # "signVideoFailure",
    # "signVideoRedirect",
    # "signupFailure",
    # "signupSuccess",
    # "softKeyboardDisappear",
    # "softKeyboardPop",
    # "startChallenge",
    # "startChapter",
    # "startGuideVideo",
    # "startLearning",
    # "startPaymentVideo",
    # "startPractice",
    # "startProblemSet",
    # "startTopic",
    # "startVideo",
    # "submitAnswer",
    # "switchBookSuccess",
    # "switchGradeSuccess",
    # "switchLogin",
    # "switchRegister",
    # "terminateProblemSet",
    # "testUserSpeedFailed",
    # "testUserSpeedSuccess",
    # "transcationInTheQueue",
    # "treasureOpened",
    # "unknownInternalError",
    # "updateProfile",
    # "updateStudentPassword",
    # "useTrialCoupon",
    # "userExhtLoading",
    # "userExitLoading",
    # "userVigoured",
    # "userguide_jumpbtnclicked",
    # "videoAudioMismatch",
    # "videoFinished",
    # "videoLagged",
    # "videoLoadDeferred",
    # "videoLoadFailed",
    # "videoQuitted"
]

"""
    Part.2 mongo class

    count_docs_by_platform:
        start,end -> datetime.datetime()
        platform -> <app|landing|web|backend|client|share>

    count_docs:
        start,end -> datetime.datetime()
"""

class collection_util(object):
    def __init__(self, arg):
        self.collecion_instance = arg

    def count_docs_by_platform(self, start, end, platform):
        collecion = self.collecion_instance
        return collecion.count({
            "serverTime": {
                "$gte": start,
                "$lt": end
            },
            "platform": platform
        })

    def count_docs(self, start, end):
        collecion = self.collecion_instance
        return collecion.count({
            "serverTime": {
                "$gte": start,
                "$lt": end
            }
        })

    def count_docs_by_key(self, start, end, event_name):
        collecion = self.collecion_instance
        return collecion.count({
            "serverTime": {
                "$gte": start,
                "$lt": end
            },
            "eventKey": event_name
        })

"""
    Part.3 mongo instance
"""

print("Mongo instance initial")
events_v4_instance = collection_util(db_events_v4_collection)

this_day_dict = {
    "date": END_DATE.strftime("%Y-%m-%d"),
}

for eventkey_name in event_list:
    this_event_count = events_v4_instance.count_docs_by_key(START_DATE, END_DATE, eventkey_name)
    this_day_dict[eventkey_name] = this_event_count

print START_DATE, END_DATE
print this_day_dict

daily_production_logs = []

with open("./eventV4DailyEachEventsCount.json", "r") as data_file:
    data = list(json.load(data_file))
    data.append(this_day_dict)
    daily_production_logs = data

with open("./eventV4DailyEachEventsCount.json", "w") as outfile:
    json.dump(daily_production_logs, outfile)
